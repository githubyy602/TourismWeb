<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yangy.web.mapper.ViewMapper">
    
    <select id="selectViewList" resultType="com.yangy.web.entity.View" 
            parameterType="com.yangy.web.common.PageBean">
        select
            tv.*,
            tp.url pictureUrl,
            tl.line_plane lineDesc
        from
            tb_view tv
        left join tb_picture tp on
            tv.picture_id = tp.id
        left join tb_line tl on
            tv.line_id = tl.id
        where 1=1
        <if test="queryName != null and queryName != '' ">
            and tv.view_title like concat('%',#{queryName},'%')
        </if>
        order by tv.create_time desc
        limit #{pageIndex},#{pageSize}
    </select>
    
    <select id="selectViewRecord" parameterType="java.lang.Integer" resultType="com.yangy.web.entity.View">
        select
            tv.*,
            tp.url pictureUrl,
            tl.line_plane lineDesc
        from
            tb_view tv
        left join tb_picture tp on
            tv.picture_id = tp.id
        left join tb_line tl on
            tv.line_id = tl.id
        where tv.id = #{0} limit 1
    </select>
    
</mapper>
